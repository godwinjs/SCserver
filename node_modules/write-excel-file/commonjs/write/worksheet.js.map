{"version":3,"file":"worksheet.js","names":["WORKSHEET_TEMPLATE","generateWorksheet","data_","schema","columns","headerStyle","getStyle","getSharedString","customFont","dateFormat","orientation","stickyRowsCount","stickyColumnsCount","sheetId","validateData","processMergedCells","data","mergedCells","replace","generateRows","generateViews","generateColumnsDescription","generateMergedCellsDescription","generateLayout","Array","isArray","TypeError","length"],"sources":["../../source/write/worksheet.js"],"sourcesContent":["// Copy-pasted from:\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/zipcelx.js\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/templates/worksheet.xml.js\r\n\r\nimport generateRows from './rows.js'\r\nimport generateColumnsDescription from './columns.js'\r\nimport processMergedCells from './processMergedCells.js'\r\nimport generateMergedCellsDescription from './generateMergedCellsDescription.js'\r\nimport generateLayout from './layout.js'\r\nimport generateViews from './views.js'\r\n\r\n// const WORKSHEET_TEMPLATE = `<?xml version=\"1.0\" ?>\r\n// <worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:mv=\"urn:schemas-microsoft-com:mac:vml\" xmlns:mx=\"http://schemas.microsoft.com/office/mac/excel/2008/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\" xmlns:xm=\"http://schemas.microsoft.com/office/excel/2006/main\"><sheetData>{data}</sheetData></worksheet>`;\r\n\r\nconst WORKSHEET_TEMPLATE = `<?xml version=\"1.0\" ?>\r\n<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:mv=\"urn:schemas-microsoft-com:mac:vml\" xmlns:mx=\"http://schemas.microsoft.com/office/mac/excel/2008/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\" xmlns:xm=\"http://schemas.microsoft.com/office/excel/2006/main\">{views}{columnsDescription}<sheetData>{data}</sheetData>{mergedCellsDescription}{layout}</worksheet>`;\r\n\r\nexport default function generateWorksheet(data_, {\r\n\tschema,\r\n\tcolumns,\r\n\theaderStyle,\r\n\tgetStyle,\r\n\tgetSharedString,\r\n\tcustomFont,\r\n\tdateFormat,\r\n\torientation,\r\n\tstickyRowsCount,\r\n\tstickyColumnsCount,\r\n\tsheetId\r\n}) {\r\n\tvalidateData(data_, { schema })\r\n\r\n\tconst { data, mergedCells } = processMergedCells(data_, { schema })\r\n\r\n  return WORKSHEET_TEMPLATE\r\n  \t.replace('{data}', generateRows(data, {\r\n  \t\tschema,\r\n  \t\theaderStyle,\r\n  \t\tgetStyle,\r\n  \t\tgetSharedString,\r\n  \t\tcustomFont,\r\n  \t\tdateFormat\r\n  \t}))\r\n  \t.replace('{views}', generateViews({ stickyRowsCount, stickyColumnsCount }))\r\n  \t.replace('{columnsDescription}', generateColumnsDescription({ schema, columns }))\r\n  \t.replace('{mergedCellsDescription}', generateMergedCellsDescription(mergedCells))\r\n  \t.replace('{layout}', generateLayout({ sheetId, orientation }))\r\n}\r\n\r\nfunction validateData(data, { schema }) {\r\n\tif (schema) {\r\n\t\tif (!Array.isArray(data)) {\r\n\t\t\tthrow new TypeError('Expected an array of objects')\r\n\t\t}\r\n\t} else {\r\n\t\tif (!Array.isArray(data)) {\r\n\t\t\tthrow new TypeError('Expected an array of arrays')\r\n\t\t}\r\n\t\tif (data.length > 0) {\r\n\t\t\tif (!Array.isArray(data[0])) {\r\n\t\t\t\tthrow new TypeError('Expected an array of arrays')\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}"],"mappings":";;;;;;;AAIA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AATA;AACA;AACA;AASA;AACA;AAEA,IAAMA,kBAAkB,wrBAAxB;;AAGe,SAASC,iBAAT,CAA2BC,KAA3B,QAYZ;EAAA,IAXFC,MAWE,QAXFA,MAWE;EAAA,IAVFC,OAUE,QAVFA,OAUE;EAAA,IATFC,WASE,QATFA,WASE;EAAA,IARFC,QAQE,QARFA,QAQE;EAAA,IAPFC,eAOE,QAPFA,eAOE;EAAA,IANFC,UAME,QANFA,UAME;EAAA,IALFC,UAKE,QALFA,UAKE;EAAA,IAJFC,WAIE,QAJFA,WAIE;EAAA,IAHFC,eAGE,QAHFA,eAGE;EAAA,IAFFC,kBAEE,QAFFA,kBAEE;EAAA,IADFC,OACE,QADFA,OACE;EACFC,YAAY,CAACZ,KAAD,EAAQ;IAAEC,MAAM,EAANA;EAAF,CAAR,CAAZ;;EAEA,0BAA8B,IAAAY,+BAAA,EAAmBb,KAAnB,EAA0B;IAAEC,MAAM,EAANA;EAAF,CAA1B,CAA9B;EAAA,IAAQa,IAAR,uBAAQA,IAAR;EAAA,IAAcC,WAAd,uBAAcA,WAAd;;EAEC,OAAOjB,kBAAkB,CACvBkB,OADK,CACG,QADH,EACa,IAAAC,gBAAA,EAAaH,IAAb,EAAmB;IACrCb,MAAM,EAANA,MADqC;IAErCE,WAAW,EAAXA,WAFqC;IAGrCC,QAAQ,EAARA,QAHqC;IAIrCC,eAAe,EAAfA,eAJqC;IAKrCC,UAAU,EAAVA,UALqC;IAMrCC,UAAU,EAAVA;EANqC,CAAnB,CADb,EASLS,OATK,CASG,SATH,EASc,IAAAE,iBAAA,EAAc;IAAET,eAAe,EAAfA,eAAF;IAAmBC,kBAAkB,EAAlBA;EAAnB,CAAd,CATd,EAULM,OAVK,CAUG,sBAVH,EAU2B,IAAAG,mBAAA,EAA2B;IAAElB,MAAM,EAANA,MAAF;IAAUC,OAAO,EAAPA;EAAV,CAA3B,CAV3B,EAWLc,OAXK,CAWG,0BAXH,EAW+B,IAAAI,0CAAA,EAA+BL,WAA/B,CAX/B,EAYLC,OAZK,CAYG,UAZH,EAYe,IAAAK,kBAAA,EAAe;IAAEV,OAAO,EAAPA,OAAF;IAAWH,WAAW,EAAXA;EAAX,CAAf,CAZf,CAAP;AAaD;;AAED,SAASI,YAAT,CAAsBE,IAAtB,SAAwC;EAAA,IAAVb,MAAU,SAAVA,MAAU;;EACvC,IAAIA,MAAJ,EAAY;IACX,IAAI,CAACqB,KAAK,CAACC,OAAN,CAAcT,IAAd,CAAL,EAA0B;MACzB,MAAM,IAAIU,SAAJ,CAAc,8BAAd,CAAN;IACA;EACD,CAJD,MAIO;IACN,IAAI,CAACF,KAAK,CAACC,OAAN,CAAcT,IAAd,CAAL,EAA0B;MACzB,MAAM,IAAIU,SAAJ,CAAc,6BAAd,CAAN;IACA;;IACD,IAAIV,IAAI,CAACW,MAAL,GAAc,CAAlB,EAAqB;MACpB,IAAI,CAACH,KAAK,CAACC,OAAN,CAAcT,IAAI,CAAC,CAAD,CAAlB,CAAL,EAA6B;QAC5B,MAAM,IAAIU,SAAJ,CAAc,6BAAd,CAAN;MACA;IACD;EACD;AACD"}