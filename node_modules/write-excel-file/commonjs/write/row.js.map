{"version":3,"file":"row.js","names":["generateRow","row","rowIndex","getStyle","getSharedString","customFont","dateFormat","usesSchema","rowNumber","rowHeight","rowCells","map","cell","columnIndex","undefined","height","cellStyleProperties","getCellStyleProperties","type","value","format","isEmpty","detectValueType","String","Date","Number","Error","cellStyleId","generateCell","join","Boolean"],"sources":["../../source/write/row.js"],"sourcesContent":["// Copy-pasted from:\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/formatters/rows/formatRow.js\r\n\r\nimport generateCell from './cell.js'\r\nimport getCellStyleProperties from './getCellStyleProperties.js'\r\n\r\n// import Integer from '../types/Integer.js'\r\n\r\nexport default function generateRow(row, rowIndex, {\r\n\tgetStyle,\r\n\tgetSharedString,\r\n\tcustomFont,\r\n\tdateFormat,\r\n\tusesSchema\r\n}) {\r\n\t// To ensure the row number starts as in Excel.\r\n\tconst rowNumber = rowIndex + 1\r\n\tlet rowHeight\r\n\tconst rowCells = row\r\n\t\t.map((cell, columnIndex) => {\r\n\t\t\tif (cell === undefined || cell === null) {\r\n\t\t\t\treturn ''\r\n\t\t\t}\r\n\r\n\t\t\tconst {\r\n\t\t\t\theight\r\n\t\t\t} = cell\r\n\r\n\t\t\tconst cellStyleProperties = getCellStyleProperties(cell)\r\n\r\n\t\t\tlet {\r\n\t\t\t\ttype,\r\n\t\t\t\tvalue,\r\n\t\t\t\tformat\r\n\t\t\t} = cell\r\n\r\n\t\t\tif (isEmpty(value)) {\r\n\t\t\t\tvalue = null\r\n\t\t\t} else {\r\n\t\t\t\t// Get cell value type.\r\n\t\t\t\tif (type === undefined) {\r\n\t\t\t\t\tif (!usesSchema) {\r\n\t\t\t\t\t\ttype = detectValueType(value)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (type === undefined) {\r\n\t\t\t\t\t\t// The default cell value type is `String`.\r\n\t\t\t\t\t\ttype = String\r\n\t\t\t\t\t\tvalue = String(value)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Validate `format` property.\r\n\t\t\tif (format) {\r\n\t\t\t\tif (type !== Date &&  type !== Number) { // && type !== Integer) {\r\n\t\t\t\t\tthrow new Error('`format` can only be used on `Date` or `Number` cells') // or `Integer` cells')\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (type === Date) {\r\n\t\t\t\t\tformat = dateFormat\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet cellStyleId\r\n\t\t\tif (\r\n\t\t\t\tformat ||\r\n\t\t\t\tcustomFont ||\r\n\t\t\t\tcellStyleProperties\r\n\t\t\t) {\r\n\t\t\t\tcellStyleId = getStyle(cellStyleProperties || {}, { format })\r\n\t\t\t}\r\n\r\n\t\t\tif (height) {\r\n\t\t\t\tif (rowHeight === undefined || rowHeight < height) {\r\n\t\t\t\t\trowHeight = height\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn generateCell(\r\n\t\t\t\trowNumber,\r\n\t\t\t\tcolumnIndex,\r\n\t\t\t\tvalue,\r\n\t\t\t\ttype,\r\n\t\t\t\tcellStyleId,\r\n\t\t\t\tgetSharedString\r\n\t\t\t)\r\n\t\t})\r\n\t\t.join('')\r\n\r\n\treturn `<row r=\"${rowNumber}\"` +\r\n\t\t(rowHeight ? ` ht=\"${rowHeight}\" customHeight=\"1\"` : '') +\r\n\t\t'>' +\r\n\t\trowCells +\r\n\t\t'</row>'\r\n}\r\n\r\nfunction isEmpty(value) {\r\n  return value === undefined || value === null || value === ''\r\n}\r\n\r\nfunction detectValueType(value) {\r\n  switch (typeof value) {\r\n    case 'string':\r\n      return String\r\n    case 'number':\r\n      return Number\r\n    case 'boolean':\r\n      return Boolean\r\n    default:\r\n      if (value instanceof Date) {\r\n        return Date\r\n      }\r\n  }\r\n}"],"mappings":"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"}