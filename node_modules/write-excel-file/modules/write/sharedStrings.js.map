{"version":3,"file":"sharedStrings.js","names":["$text","initSharedStrings","sharedStrings","sharedStringsIndex","getSharedStringsXml","generateXml","getSharedString","string","id","undefined","String","length","push","xml","attributes","trim"],"sources":["../../source/write/sharedStrings.js"],"sourcesContent":["import $text from '../xml/sanitizeText.js'\r\n\r\nexport default function initSharedStrings() {\r\n\tconst sharedStrings = []\r\n\tconst sharedStringsIndex = {}\r\n\r\n\treturn {\r\n\t\tgetSharedStringsXml() {\r\n\t\t\treturn generateXml(sharedStrings)\r\n\t\t},\r\n\r\n\t\tgetSharedString(string) {\r\n      let id = sharedStringsIndex[string]\r\n      if (id === undefined) {\r\n\t\t\t\tid = String(sharedStrings.length)\r\n\t\t\t\tsharedStringsIndex[string] = id\r\n\t\t\t\tsharedStrings.push(string)\r\n      }\r\n      return id\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction generateXml(sharedStrings) {\r\n\tlet xml = '<?xml version=\"1.0\"?>'\r\n\txml += '<sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\">'\r\n\tfor (const string of sharedStrings) {\r\n\t\tconst attributes = string.trim().length === string.length ? '' : ' xml:space=\"preserve\"';\r\n\t\txml += `<si><t${attributes}>`\r\n\t\txml += $text(string)\r\n\t\txml += '</t></si>'\r\n\t}\r\n\txml += '</sst>'\r\n\treturn xml\r\n}"],"mappings":";;;;;;AAAA,OAAOA,KAAP,MAAkB,wBAAlB;AAEA,eAAe,SAASC,iBAAT,GAA6B;EAC3C,IAAMC,aAAa,GAAG,EAAtB;EACA,IAAMC,kBAAkB,GAAG,EAA3B;EAEA,OAAO;IACNC,mBADM,iCACgB;MACrB,OAAOC,WAAW,CAACH,aAAD,CAAlB;IACA,CAHK;IAKNI,eALM,2BAKUC,MALV,EAKkB;MACpB,IAAIC,EAAE,GAAGL,kBAAkB,CAACI,MAAD,CAA3B;;MACA,IAAIC,EAAE,KAAKC,SAAX,EAAsB;QACxBD,EAAE,GAAGE,MAAM,CAACR,aAAa,CAACS,MAAf,CAAX;QACAR,kBAAkB,CAACI,MAAD,CAAlB,GAA6BC,EAA7B;QACAN,aAAa,CAACU,IAAd,CAAmBL,MAAnB;MACG;;MACD,OAAOC,EAAP;IACH;EAbK,CAAP;AAeA;;AAED,SAASH,WAAT,CAAqBH,aAArB,EAAoC;EACnC,IAAIW,GAAG,GAAG,uBAAV;EACAA,GAAG,IAAI,yEAAP;;EACA,qDAAqBX,aAArB,wCAAoC;IAAA,IAAzBK,MAAyB;IACnC,IAAMO,UAAU,GAAGP,MAAM,CAACQ,IAAP,GAAcJ,MAAd,KAAyBJ,MAAM,CAACI,MAAhC,GAAyC,EAAzC,GAA8C,uBAAjE;IACAE,GAAG,oBAAaC,UAAb,MAAH;IACAD,GAAG,IAAIb,KAAK,CAACO,MAAD,CAAZ;IACAM,GAAG,IAAI,WAAP;EACA;;EACDA,GAAG,IAAI,QAAP;EACA,OAAOA,GAAP;AACA"}