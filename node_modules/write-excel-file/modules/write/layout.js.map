{"version":3,"file":"layout.js","names":["$attr","generateLayout","sheetId","orientation","layout","marginLeft","marginRight","marginTop","marginBottom","header","footer","paperSize"],"sources":["../../source/write/layout.js"],"sourcesContent":["import $attr from '../xml/sanitizeAttributeValue.js'\r\n\r\nexport default function generateLayout({\r\n\tsheetId,\r\n\torientation\r\n}) {\r\n\tlet layout = ''\r\n\r\n\t// Margins are required when setting custom orientation,\r\n\t// otherwise they'd be `0`.\r\n\t// https://gitlab.com/catamphetamine/write-excel-file/-/issues/7#note_782347297\r\n\tif (orientation) {\r\n\t\t// Page margins (when printing).\r\n\t\t// https://github.com/randym/axlsx/blob/master/lib/axlsx/workbook/worksheet/page_margins.rb\r\n\r\n\t\tconst marginLeft = 0.7 // The left margin in inches.\r\n\t\tconst marginRight = 0.7 // The right margin in inches.\r\n\t\tconst marginTop = 0.75 // The top margin in inches.\r\n\t\tconst marginBottom = 0.75 // The bottom margin in inches.\r\n\t\tconst header = 0.3 // The header margin in inches.\r\n\t\tconst footer = 0.3 // The footer margin in inches.\r\n\r\n\t\tlayout += '<pageMargins'\r\n\t\tlayout += ` left=\"${marginLeft}\"`\r\n\t\tlayout += ` right=\"${marginRight}\"`\r\n\t\tlayout += ` top=\"${marginTop}\"`\r\n\t\tlayout += ` bottom=\"${marginBottom}\"`\r\n\t\tlayout += ` header=\"${header}\"`\r\n\t\tlayout += ` footer=\"${footer}\"`\r\n\t\tlayout += '/>'\r\n\t}\r\n\r\n\t// Allows setting \"landscape\" orientation.\r\n\t// https://gitlab.com/catamphetamine/write-excel-file/-/issues/7\r\n\tif (orientation) {\r\n\t\t// Paper size (when printing).\r\n\t\t// https://github.com/randym/axlsx/blob/master/lib/axlsx/workbook/worksheet/page_setup.rb\r\n\t\t//\r\n\t\t// `paperSize` `9` means \"A4 paper (210 mm by 297 mm)\".\r\n\t\t//\r\n\t\tconst paperSize = 9\r\n\r\n\t\t// Page orientation (when printing).\r\n\t\t//\r\n\t\t// `orientation` can be:\r\n\t\t// * `landscape`\r\n\t\t// * `portrait`\r\n\t\t// https://docs.microsoft.com/en-us/office/vba/api/excel.pagesetup.orientation\r\n\r\n\t\tlayout += '<pageSetup'\r\n\t\tlayout += ` paperSize=\"${paperSize}\"`\r\n\t\tlayout += ` orientation=\"${$attr(orientation)}\"`\r\n\t\tlayout += ` r:id=\"rId${sheetId}\"`\r\n\t\tlayout += '/>'\r\n\t}\r\n\r\n\treturn layout\r\n}"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,kCAAlB;AAEA,eAAe,SAASC,cAAT,OAGZ;EAAA,IAFFC,OAEE,QAFFA,OAEE;EAAA,IADFC,WACE,QADFA,WACE;EACF,IAAIC,MAAM,GAAG,EAAb,CADE,CAGF;EACA;EACA;;EACA,IAAID,WAAJ,EAAiB;IAChB;IACA;IAEA,IAAME,UAAU,GAAG,GAAnB,CAJgB,CAIO;;IACvB,IAAMC,WAAW,GAAG,GAApB,CALgB,CAKQ;;IACxB,IAAMC,SAAS,GAAG,IAAlB,CANgB,CAMO;;IACvB,IAAMC,YAAY,GAAG,IAArB,CAPgB,CAOU;;IAC1B,IAAMC,MAAM,GAAG,GAAf,CARgB,CAQG;;IACnB,IAAMC,MAAM,GAAG,GAAf,CATgB,CASG;;IAEnBN,MAAM,IAAI,cAAV;IACAA,MAAM,sBAAcC,UAAd,OAAN;IACAD,MAAM,uBAAeE,WAAf,OAAN;IACAF,MAAM,qBAAaG,SAAb,OAAN;IACAH,MAAM,wBAAgBI,YAAhB,OAAN;IACAJ,MAAM,wBAAgBK,MAAhB,OAAN;IACAL,MAAM,wBAAgBM,MAAhB,OAAN;IACAN,MAAM,IAAI,IAAV;EACA,CAzBC,CA2BF;EACA;;;EACA,IAAID,WAAJ,EAAiB;IAChB;IACA;IACA;IACA;IACA;IACA,IAAMQ,SAAS,GAAG,CAAlB,CANgB,CAQhB;IACA;IACA;IACA;IACA;IACA;;IAEAP,MAAM,IAAI,YAAV;IACAA,MAAM,2BAAmBO,SAAnB,OAAN;IACAP,MAAM,6BAAqBJ,KAAK,CAACG,WAAD,CAA1B,OAAN;IACAC,MAAM,yBAAiBF,OAAjB,OAAN;IACAE,MAAM,IAAI,IAAV;EACA;;EAED,OAAOA,MAAP;AACA"}