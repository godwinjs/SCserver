{"version":3,"file":"generateMergedCellsDescription.js","names":["generateCellNumber","generateMergedCellsDescription","mergedCells","length","map","from","to","coordinates","join"],"sources":["../../source/write/generateMergedCellsDescription.js"],"sourcesContent":["import generateCellNumber from './generateCellNumber.js'\r\n\r\n// Supports \"merging cells\" across columns and rows.\r\n// https://rdrr.io/cran/openxlsx/man/mergeCells.html\r\n//\r\n// Returned XML example for merged cells range \"A2:C3\":\r\n// `<sheetData>...</sheetData><mergeCells count=\"1\"><mergeCell ref=\"A2:C3\"/></mergeCells>`\r\n//\r\n// Data example:\r\n//\r\n// rows:\r\n// [\r\n//   [...],\r\n//   [\r\n//     { type: String, value: 'abc', span: 3, rowSpan: 2 },\r\n//     { ... },\r\n//     { ... }\r\n//   ],\r\n//   [...]\r\n// ]\r\n\r\nexport default function generateMergedCellsDescription(mergedCells) {\r\n\tif (mergedCells.length === 0) {\r\n\t\treturn ''\r\n\t}\r\n\r\n\treturn `<mergeCells count=\"${mergedCells.length}\">` +\r\n\t\tmergedCells.map(([from, to]) => {\r\n\t\t\tconst coordinates =\r\n\t\t\t\tgenerateCellNumber(from[1], from[0] + 1) +\r\n\t\t\t\t':' +\r\n\t\t\t\tgenerateCellNumber(to[1], to[0] + 1)\r\n\t\t\treturn `<mergeCell ref=\"${coordinates}\"/>`\r\n\t\t}).join('') +\r\n\t\t'</mergeCells>'\r\n}"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,kBAAP,MAA+B,yBAA/B,C,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,eAAe,SAASC,8BAAT,CAAwCC,WAAxC,EAAqD;EACnE,IAAIA,WAAW,CAACC,MAAZ,KAAuB,CAA3B,EAA8B;IAC7B,OAAO,EAAP;EACA;;EAED,OAAO,8BAAsBD,WAAW,CAACC,MAAlC,WACND,WAAW,CAACE,GAAZ,CAAgB,gBAAgB;IAAA;IAAA,IAAdC,IAAc;IAAA,IAARC,EAAQ;;IAC/B,IAAMC,WAAW,GAChBP,kBAAkB,CAACK,IAAI,CAAC,CAAD,CAAL,EAAUA,IAAI,CAAC,CAAD,CAAJ,GAAU,CAApB,CAAlB,GACA,GADA,GAEAL,kBAAkB,CAACM,EAAE,CAAC,CAAD,CAAH,EAAQA,EAAE,CAAC,CAAD,CAAF,GAAQ,CAAhB,CAHnB;IAIA,kCAA0BC,WAA1B;EACA,CAND,EAMGC,IANH,CAMQ,EANR,CADM,GAQN,eARD;AASA"}